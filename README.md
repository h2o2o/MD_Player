# markdown本地图片处理

## 这是什么？

这是一个将本地的markdown图片链接批量上传后替换本地链接为图床链接的一个小脚本。


---

## 做这个干啥？

找了好久，一直没有找到我觉得完美的markdown软件，有的功能太简陋，有的太臃肿，有的觉得隐私不安全。还有的很不错，但是付费太贵或者有广告，或者不能同步。

后来，发现了joplin，功能对我而言很完美了，可以同步，可以备份文档到自建的webdav中，可以对文档进行加密，有网页剪藏，可以检索文档。

但是，joplin的图片是本地的，直接用于生成hexo的博客，图片不能显示，所以想把本地的图片链接替换成图床的链接，然后只用修改少量的参数，例如：分类和标签就可以直接生成博文了。

这样，即使图床不能正常使用了，需要更换图床，也可以直接导出本地文件，在重新生成新的文件。

---

## 有什么功能？

1. 批量上传转换图片链接
2. 自定义图片压缩率
3. 自定义压缩图片大小，防止小图片被再次压缩，导致看不清楚
4. 记录已经转换过的文件
5. 替换本地的图片链接

---

## 怎么使用？

1. 安装Python
2. 安装opencv-python，pypinyin，腾讯云os cdk，这一步可以使用下面的代码，一步安装。

```bssh
pip install -r requirements.txt
```

3. 创建腾讯云oss存储桶
3. 修改配置文件
4. 运行md_player.py文件

## 自定义修改

### 1. 图片上传方式

默认的方式是使用的腾讯云oss的sdk进行文件上传，如果需要使用其他的方式，可以自己修改md_player.py中的 upload_img 函数，在其中自定是上传的方式。 return最终返回一个图片的真实链接就可以了

```Python
# 这里 img_url 返回的是图片上传之后的引用地址
return img_url
```

### 2. 其他配置

其他自定义配置修改config.py中的文件即可

### 3. Transfrom_md.py

这个文件是记录转换过的文件的记录，后面的转换可以不重复去转换已经转换过的，如果之前转换过的md文档需要更新，可以直接选择全部转换。